# vulnerability/open_redirect.py

import requests
import re

def is_open_redirect_vulnerable(url):
    # Example payload for an open redirect vulnerability
    payload = "https://example.com"
    response = requests.get(url + "?redirect=" + payload)

    # Check if the redirect location matches the injected payload
    if response.history and response.history[0].status_code == 302:
        for res in response.history:
            if payload in res.headers.get("Location", ""):
                return True
    return False
