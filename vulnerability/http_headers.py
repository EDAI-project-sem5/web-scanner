# vulnerability/http_headers.py

import requests

def check_http_headers(url):
    response = requests.get(url)
    headers = response.headers
    vulnerabilities = {}

    # Check for Content Security Policy (CSP)
    if "Content-Security-Policy" not in headers:
        vulnerabilities["Missing CSP"] = "Content Security Policy header is missing, increasing the risk of XSS attacks."

    # Check for Strict-Transport-Security (HSTS)
    if "Strict-Transport-Security" not in headers:
        vulnerabilities["Missing HSTS"] = "Strict-Transport-Security header is missing, making the site vulnerable to MitM attacks."

    # Check for X-Frame-Options (Clickjacking Protection)
    if "X-Frame-Options" not in headers:
        vulnerabilities["Missing X-Frame-Options"] = "X-Frame-Options header is missing, making the site vulnerable to Clickjacking attacks."

    # Check for X-Content-Type-Options (MIME Sniffing Prevention)
    if "X-Content-Type-Options" not in headers:
        vulnerabilities["Missing X-Content-Type-Options"] = "X-Content-Type-Options header is missing, which could allow MIME sniffing attacks."

    return vulnerabilities
