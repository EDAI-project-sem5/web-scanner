# vulnerability/sensitive_info.py

import requests
import re

def is_sensitive_info_disclosed(url):
    # Patterns to detect sensitive information in web content
    sensitive_patterns = [
        r"\b\d{3}-\d{2}-\d{4}\b",  # Social Security Numbers (SSNs)
        r"\b\d{16}\b",  # Credit Card Numbers
        r"\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}\b",  # Email addresses
        r"password\b",  # Passwords in plaintext
        r"secret\b"  # API keys or other secrets
    ]

    # Send GET request to the URL
    response = requests.get(url)
    
    # Scan the response content for sensitive data
    for pattern in sensitive_patterns:
        if re.search(pattern, response.text, re.IGNORECASE):
            return True
    return False
